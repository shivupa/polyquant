#ifndef POLYQUANT_INTEGRAL_H
#define POLYQUANT_INTEGRAL_H
#include "basis/basis.hpp"
#include "io/lfu_cache.hpp"
#include "io/timer.hpp"
#include "io/utils.hpp"
#include "molecule/molecule.hpp"
#include <libint2.hpp> // IWYU pragma: keep
#include <numeric>
#include <vector>

namespace polyquant {

template <typename T> inline int symmetric_matrix_triangular_idx(const T &i, const T &j) {
  if (i > j) {
    return ((i * (i + 1)) / 2) + j;
  } else {
    return ((j * (j + 1)) / 2) + i;
  }
}

/**
 * @brief A class to calculate integrals for a given molecule in a given basis.
 *
 */
class POLYQUANT_INTEGRAL {
public:
  POLYQUANT_INTEGRAL() = default;
  /**
   * @brief Construct a new polyquant integral object by calling to
   * setup_integral
   *
   * @param input the input parameters
   * @param basis the basis to calculate integrals in
   * @param molecule the molecule to calculate integrals for
   */
  POLYQUANT_INTEGRAL(const POLYQUANT_INPUT &input, const POLYQUANT_BASIS &basis, const POLYQUANT_MOLECULE &molecule);
  ~POLYQUANT_INTEGRAL();
  void construct_ijcache(size_t size_in_gb = 10000);
  void construct_ericache(size_t size_in_gb = 10000);

  void calculate_overlap();
  void calculate_Schwarz();
  void calculate_frozen_core_ints(std::vector<std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>>> &fc_dm, std::vector<int> &frozen_core);
  void calculate_unique_shell_pairs(double threshold = -1.0);
  void calculate_kinetic();
  void calculate_nuclear();
  void calculate_polarization_potential();
  //  void calculate_two_electron();
  std::pair<std::vector<size_t>, std::vector<size_t>> make_sorted_ijkl_idx(const size_t &quantum_part_a_idx, const size_t &quantum_part_b_idx, const size_t &i, const size_t &j, const size_t &k,
                                                                           const size_t &l);

  /**
   * @brief Create the matricies and vector to hold the integrals and call to
   * the functions to calculate them.
   *
   * @param input the input parameters
   * @param basis the basis to calculate integrals in
   * @param molecule the molecule to calculate integrals for
   */
  void setup_integral(const POLYQUANT_INPUT &input, const POLYQUANT_BASIS &basis, const POLYQUANT_MOLECULE &molecule);
  /**
   * @brief Calculate the combined index for the vector containing the upper
   * triangle of a symmetric matrix from two indicies of the unflattened matrix.
   *
   * @param i index for the symmetric matrix
   * @param j index for the symmetric matrix
   * @return int combined index for the flattened upper triangle of the
   * symmetric matrix
   */
  template <typename T> const T idx2(const T &i, const T &j) const {
    std::pair<T, T> ij_idx;
    ij_idx = std::make_pair(i, j);
    auto cached_ij_elem = this->ijcache.get(ij_idx);
    if (cached_ij_elem.has_value()) {
      return cached_ij_elem.value();
    } else {
      auto ij_elem = symmetric_matrix_triangular_idx(i, j);
      this->ijcache.set(ij_idx, ij_elem);
      return ij_elem;
    }
  }
  /**
   * @brief Calculate the combined index for the vector containing the unique
   * elements of a 4D symmetric tensor with 8 fold symmetry from four indicies
   * of the unflattened tensor.
   *
   * @param i index for the symmetric tensor
   * @param j index for the symmetric tensor
   * @param k index for the symmetric tensor
   * @param l index for the symmetric tensor
   * @return int combined index for the flattened unique elements of the
   * symmetric tensor
   */
  template <typename T> const T idx8(const T &i, const T &j, const T &k, const T &l) const { return idx2(idx2(i, j), idx2(k, l)); }

  /**
   * @brief Calculate one body integrals
   *
   * @param output_matrix the matrix to hold the one body ints
   * @param shells the basis set to calculate the one body integrals in
   * @param obtype the operator to calculate the integrals for
   * @param atoms if the operator is nuclear attraction coulomb, the we need to
   * know where the nuclei are
   */
  void compute_1body_ints(Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> &output_matrix, const libint2::BasisSet &shells, libint2::Operator obtype,
                          const std::vector<libint2::Atom> &atoms = std::vector<libint2::Atom>());

  /**
   * @brief Calculate Schwarz integrals (diagonal 2 body ints)
   *
   * @param output_matrix the matrix to hold the diagonal two body ints
   * @param shells the basis set to calculate the one body integrals in
   * @param obtype the operator to calculate the integrals for
   */
  void compute_Schwarz_ints(Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> &output_matrix, const libint2::BasisSet &shells_a, const libint2::BasisSet &shells_b, libint2::Operator obtype);
  std::tuple<std::unordered_map<size_t, std::vector<size_t>>, std::vector<std::vector<std::shared_ptr<libint2::ShellPair>>>> compute_shellpairs(const libint2::BasisSet &bs1, const double threshold);

  void compute_frozen_core_ints(Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> &output_matrix, std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>> &fc_dm,
                                const size_t quantum_part_a_idx, const size_t quantum_part_b_idx, libint2::Operator obtype);
  // double primitive_integral_operator_expanded_in_gaussians(
  //     const Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> &origin1,
  //     const double &cont_coeff1, const double &exp1, const xt::xarray<int>
  //     &angular_momentum_1, const Eigen::Matrix<double, Eigen::Dynamic,
  //     Eigen::Dynamic> &origin2, const double &cont_coeff2, const double
  //     &exp2, const xt::xarray<int> &angular_momentum_2, const
  //     Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> &operator_origin,
  //     const Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>
  //     &operator_coeff, const Eigen::Matrix<double, Eigen::Dynamic,
  //     Eigen::Dynamic> &operator_exps);
  /**
   * @brief Calculate one body integrals with an operator that has been expanded
   * as a sum of gaussians
   *
   * @param output_matrix the matrix to hold the one body ints
   * @param shells the basis set to calculate the one body integrals in
   * @param operator_coeff the coefficients of the gaussians that the operator
   * has been expanded in
   * @param operator_exps the exponents of the gaussians that the operator has
   * been expanded in
   */
  // void compute_1body_ints_operator_expanded_in_gaussians(
  //     Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> &output_matrix,
  //     const libint2::BasisSet &shells, const Eigen::Matrix<double,
  //     Eigen::Dynamic, Eigen::Dynamic> &operator_origin, const
  //     Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> &operator_coeff,
  //     const Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>
  //     &operator_exps);
  /**
   * @brief Calculate two body integrals
   *
   * @param output_vec the vector to hold the two body ints
   * @param shells the basis set to ccalculate the two body integrals in
   * @param obtype the operator just the coulomb operator
   */
  void compute_2body_ints(Eigen::Matrix<double, Eigen::Dynamic, 1> &output_vec, const libint2::BasisSet &shells, libint2::Operator obtype);

  void symmetric_orthogonalization();

  /**
   * @brief Overlap integral matrix
   *
   */
  std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>> overlap;
  /**
   * @brief Kinetic integral matrix
   *
   */
  std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>> kinetic;
  /**
   * @brief Nuclear attraction integral matrix
   *
   */
  std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>> nuclear;
  /**
   * @brief Schwarz screening integrals (ij|ij)
   *
   */
  std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>> Schwarz;
  /**
   * @brief Frozen core effective one body integrals
   *
   */
  std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>> frozen_core_ints;
  /**
   * @brief The orthogonalization matrix
   *
   */
  std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>> orth_X;

  std::vector<std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>>> mo_one_body_ints;
  /**
   * @brief The two electron MO integrals stored as
   * [idx_part][spin_idx][idx_part][spin_idx]
   *
   */
  std::vector<std::vector<std::vector<std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>>>>> mo_two_body_ints;

  std::vector<std::tuple<std::unordered_map<size_t, std::vector<size_t>>, std::vector<std::vector<std::shared_ptr<libint2::ShellPair>>>>> unique_shell_pairs;

  void calculate_mo_1_body_integrals(std::vector<std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>>> &mo_coeff, std::vector<int> frozen_core, std::vector<int> deleted_virtual);

  Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> transform_mo_2_body_integrals(const size_t &quantum_part_a_idx, const size_t &quantum_part_b_idx,
                                                                                      Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> &mo_coeffs_a,
                                                                                      Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> &mo_coeffs_b, int num_part_alpha, int num_part_beta,
                                                                                      std::vector<int> frozen_core, std::vector<int> deleted_virtual);
  void calculate_mo_2_body_integrals(std::vector<std::vector<Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic>>> &mo_coeffs, std::vector<int> frozen_core, std::vector<int> deleted_virtual);

  size_t ijcache_size;
  size_t ericache_size;
  mutable polyquant_lfu_cache<std::pair<int, int>, int, PairHash<int>> ijcache;
  mutable polyquant_lfu_cache<std::pair<std::vector<size_t>, std::vector<size_t>>, double, PairVectorHash<size_t>> ericache;
  /**
   * @brief the input parameters
   *
   */
  POLYQUANT_INPUT input_params;
  /**
   * @brief the input basis
   *
   */
  POLYQUANT_BASIS input_basis;
  /**
   * @brief the input molecule
   *
   */
  POLYQUANT_MOLECULE input_molecule;

  double tolerance_2e = std::numeric_limits<double>::epsilon();
  /*std::unordered_map<std::string, Eigen::Matrix<double, Eigen::Dynamic,
  Eigen::Dynamic>> alpha_miller = {
      {"H",
       {0.00032373615175901847, -0.001191384594906283, 0.002269474128788352,
        -0.003618386394706905,  0.005256482800147806,  -0.009916552646920785,
        0.012398266721726888,   -0.047854802337436005, 0.026743114608026752,
        -0.5963121308194912,    2.4708299884193092,    -15.183665775059076,
        89.57097669940192,      -342.8087098590007,    682.0787356244548,
        -6.854181708544257,     -3302.0712536914616,   7608.962415502974,
        -7580.960346735136,     2953.0642901207384,    -321.7520471927617,
        1363.9994273632835,     -4290.792371948113,    5171.028173840877,
        -8134.874348589932,     23266.849207464587}},
      {"F",
       {0.0002231320489950409,  -0.0008218431280712427, 0.0015641097805763865,
        -0.0025004952493470557, 0.00361130042195987,    -0.00692349754152221,
        0.008330488426568184,   -0.03436652368499099,   0.015246902494134932,
        -0.43883786875615693,   1.7897712959916063,     -8.857539554438011,
        11.980159457437928,     406.74654137751315,     -4218.719350265337,
        20782.354324330663,     -59338.360812086576,    99961.83117717094,
        -92360.658585141,       36175.849809473424,     -7311.353850567384,
        45205.47381690337,      -167524.07410973843,    217071.99787494872,
        -367425.965881104,      1060772.8979083123}},
      {"Cl",
       {0.0017431827145923842, -0.006421258268464249, 0.01222286184602141,
        -0.019545190651971883, 0.028233227244729348,  -0.054138536417385315,
        0.06514273198882477,   -0.2687675338936043,   0.1192265612607284,
        -3.432072189800531,    13.997367639155561,    -69.26368296369016,
        93.45752415015988,     3184.1331588622966,    -33016.41692319498,
        162637.08611388865,    -464359.5504482952,    782263.1596493128,
        -722782.5072921813,    283101.3862015947,     -57218.91709532534,
        353784.0037838404,     -1311070.7144442338,   1698843.4806462766,
        -2875544.1564493445,   8301808.079071925}},
      {"Br",
       {0.002271546033741571,  -0.008366656915912107, 0.015923329273030924,
        -0.025455894992315306, 0.03676349825235471,   -0.07047834217535044,
        0.08479840107516806,   -0.34981531604722543,  0.15517907370035552,
        -4.466860850248586,    18.2175440320694,      -90.14269591503616,
        121.55915870056556,    4144.884991978083,     -42975.03844849257,
        211686.7231012347,     -604395.5438440123,    1018156.9686628687,
        -940731.4992442889,    368465.6701010056,     -74470.12487115289,
        460445.01840970403,    -1706336.9916734786,   2211015.1058297097,
        -3742467.6854909766,   10804649.121312251}},
      {"I", {0.004086214169851799, -0.015049189815926957, 0.0286377917395484,
             -0.04577320890371123, 0.06609651186116806,   -0.1266911295062101,
             0.15243270675752094,  -0.6287380012939261,   0.27897388465456624,
             -8.028130017446902,   32.741953492314536,    -162.03235145811917,
             218.95652772010428,   7443.924256024933,     -77199.94557553691,
             380298.53837404016,   -1085839.401021727,    1829221.1798517865,
             -1690135.2793802163,  661996.3617854413,     -133797.46329397065,
             827264.7086666506,    -3065714.944525003,    3972452.973289298,
             -6723961.141870003,   19412336.609896973}},
      {"CTE",
       {0.0008001168558989766, -0.002946911593378189, 0.005608219449900005,
        -0.008964989534448879, 0.012946719256108566,  -0.024819187722405715,
        0.029862565780050355,  -0.12318776966340464,  0.05465387700698403,
        -1.5729935344047326,   6.415298276787883,     -31.746518020653056,
        42.86871275938598,     1458.9314110567034,    -15129.109236726907,
        74526.80694835233,     -212789.70627692505,   358467.9160315329,
        -331211.45382959396,   129729.76072104923,    -26220.10286510636,
        162118.22045142844,    -600785.3820715952,    778478.1872718775,
        -1317689.1435872745,   3804219.7589802975}},
      {"CTR",
       {0.0010183200929143443, -0.0037509476305440516, 0.0071394106666665845,
        -0.011415364909741706, 0.016488422796558933,   -0.031616310096899934,
        0.038041202874277605,  -0.15695872853469345,   0.06961804154133439,
        -2.004357846633616,    8.174582184523278,      -40.44969134957557,
        54.571743777716506,    1859.5318617243527,     -19280.955160783615,
        94975.07457111025,     -271167.588575225,      456804.98814337223,
        -422066.70068419114,   165314.78476006028,     -33411.24077216631,
        206579.51558146277,    -765550.691880729,      991975.0050942143,
        -1679062.873599474,    4847519.366941904}},
      {"CBR",
       {0.0014285385411212674, -0.005261869687342,   0.010014986721817762,
        -0.016012464448224854, 0.023127856553177974, -0.044344273911845984,
        0.053356811582535434,  -0.22012739830175976, 0.09765482137561725,
        -2.8109097054652383,   11.464060819639752,   -56.73162793350002,
        76.6399982991529,      2606.5781991313866,   -27031.350341586003,
        133158.47516803912,    -380194.54338926653,  640477.4039864242,
        -591775.5811847541,    231787.2811930175,    -46846.33726716147,
        289648.26871885854,    -1073390.6427604782,  1390863.9233387534,
        -2354241.043698183,    6796784.923968317}},
      {"CDI",
       {0.0009651847775105668, -0.0035556412250642893, 0.0067688420360567355,
        -0.010825689051505188, 0.015639969939277604,   -0.029996406502413645,
        0.036094351853181536,  -0.14894446625714625,   0.06606503063908137,
        -1.9020790581188465,   7.757502278483196,      -38.388349121684975,
        51.842786833038154,    1764.0221281481965,     -18292.935743855487,
        90111.3828394598,      -257285.08249643416,    433422.46319381706,
        -400464.45880156255,   156854.18675287717,     -31701.595806095505,
        196009.12774496013,    -726378.7473894765,     941217.412383161,
        -1593148.3749501538,   4599480.943865449}},
      {"NTE",
       {0.0007266062066768627, -0.0026763364449283447, 0.005093763142178507,
        -0.008143604339300984, 0.011761590260166394,   -0.022549031347901486,
        0.027131835042974565,  -0.11192587315305763,   0.049660135865127186,
        -1.4292000364088266,   5.8288995826759065,     -28.847775035745716,
        39.03094083209424,     1324.5355763247767,     -13738.513247389808,
        67679.9240207975,      -193242.9958544814,     325540.0147872722,
        -300786.660535861,     117812.48558492733,     -23810.808445326973,
        147220.44029987286,    -545575.0965458313,     706937.7953877016,
        -1196595.379640733,    3454616.969049224}},
      {"NTR2",
       {0.0007755424215721778, -0.002856799500816573, 0.0054378461485585375,
        -0.008695397224253791, 0.012560461688551391,  -0.02408575516236278,
        0.02898093198448583,   -0.11957718283678075,  0.05303983744668445,
        -1.5269968122022988,   6.227714425140923,     -30.816499930462296,
        41.57948621867778,     1416.6442596223915,    -14689.037244086721,
        72356.57955773114,     -206589.68463385417,   348019.4882721285,
        -321555.0205978517,    125946.78708702186,    -25454.98886994405,
        157386.90442301685,    -583251.1448724809,    755757.5469704614,
        -1279230.571192401,    3693188.177769069}},
      {"NPI2",
       {0.0008209536350425979, -0.0030240551638846098, 0.005756167684285546,
        -0.009204159108096901, 0.013295144614421744,   -0.025492896622433685,
        0.030674990298697705,  -0.1265521182226416,    0.05614748582368048,
        -1.6159988406469354,   6.590751547446581,      -32.61786626365484,
        44.12023636197985,     1497.832505309572,      -15535.593395913678,
        76532.65086060764,     -218520.06279955024,    368123.09533757396,
        -340132.75618004863,   133223.95986412224,     -26925.95513362099,
        166481.74402342632,    -616955.0553529339,     799429.8830671132,
        -1353152.2816807479,   3906602.9704607436}},
      {"NDI",
       {0.0007208479428536441, -0.002655057699009798, 0.0050531019276057135,
        -0.008078166152652945, 0.011666641800446539,  -0.02236518886487183,
        0.02691086914080872,   -0.11100285069932814,  0.04925762961937223,
        -1.4173615706076772,   5.780611314216613,     -28.609635378603024,
        38.72232920159332,     1313.4359628530203,    -13624.072427130386,
        67117.38663006033,     -191638.86361520333,   322840.0517139815,
        -298293.63382224744,   116836.51096283694,    -23613.9485664305,
        146003.77732645403,    -541066.9131944093,    701096.5280609904,
        -1186708.6283796602,   3426073.6938816356}},
      {"OTE",
       {0.0004800198512861864, -0.0017681368788782983, 0.003365388860780689,
        -0.005380711086127366, 0.0077715306403634485,  -0.014899747044838403,
        0.017927673262056954,  -0.07395739528128721,   0.03280908041593532,
        -0.9443763937529847,   3.851527254073809,      -19.058173530339708,
        25.70585681010754,     876.2531479610246,      -9085.461629907459,
        44753.75639981563,     -127779.23118685768,    215256.37001213353,
        -198888.05377330727,   77900.71223882494,      -15744.621343110293,
        97348.47864975268,     -360758.50325471134,    467459.10695954226,
        -791243.4126816139,    2284350.454659459}},
      {"OTR4",
       {0.0004289664812432115,  -0.0015800061090226515, 0.0030070954924349275,
        -0.0048073729540405305, 0.00694291278450829,    -0.013310143337343365,
        0.016014997662858698,   -0.06606425360445972,   0.0293109784558817,
        -0.8435782819018649,    3.440455749769341,      -17.025651375793302,
        22.997067038357358,     782.3357566680571,      -8113.133508605402,
        39966.26889959053,      -114112.99055111693,    192237.07460517855,
        -177620.89042615722,    69571.24752186133,      -14061.478299738561,
        86942.06356622603,      -322194.3797822063,     417489.1971013889,
        -706662.3289166993,     2040161.7050915295}},
      {"OPI2",
       {0.0002063539028194768, -0.0007601127843399958, 0.0014468156067469747,
        -0.002313446379097824, 0.003341700859448401,   -0.006407805301999575,
        0.007710320554236849,  -0.031811264120638755,  0.014112324031939676,
        -0.4062176126774581,   1.6567212608512656,     -8.198290633915791,
        11.06846608170583,     376.7863856522865,      -3907.1818610077194,
        19246.865015849722,    -54953.69396278319,     92575.47346785894,
        -85536.33678007998,    33503.078235563466,     -6771.411967797672,
        41867.47466544566,     -155154.4886620777,     201044.15805799502,
        -340296.9057790751,    982450.3964545837}},
      {"STE",
       {0.0022611928699580335, -0.008328803256899059, 0.01585204827763997,
        -0.025343503597820997, 0.03660287455761555,   -0.07017331619177973,
        0.08443403926580655,   -0.3483142019143195,   0.1545394086062243,
        -4.447715249447561,    18.139781685134125,    -89.77796135371985,
        121.52761893171323,    4121.263846749043,     -42749.67477373784,
        210601.10275354338,    -601323.8928464556,    1013005.1159552701,
        -935982.5175618936,    366608.05318070424,    -74095.46853348272,
        458128.5300883298,     -1697752.2516150034,   2199891.151879504,
        -3723638.519600062,    10750288.496497134}},
      {"STR4",
       {0.002810466743078106,  -0.010351994007614196, 0.01970283472039711,
        -0.031500461397120996, 0.04549619421500326,   -0.0872254522762268,
        0.10495386076768567,   -0.43296075736808015,  0.19210513125208634,
        -5.528534962326959,    22.547778733495317,    -111.59192193861716,
        150.99052220291776,    5123.686144923262,     -53145.13699947961,
        261810.2688306716,     -747537.4206737562,    1259318.230666856,
        -1163566.7238186193,   455748.64367968804,    -92111.5753829306,
        569520.7672374505,     -2110553.7621358745,   2734785.3675032337,
        -4629024.946786491,    13364173.965277717}},
      {"SPI2",
       {0.0020347915759853516, -0.007494920084704168, 0.014265074742487316,
        -0.02280692591138951,  0.032940312673528524,  -0.06315408019314445,
        0.07598939110689683,   -0.31348217885350893,  0.13908506041594032,
        -4.002941996241124,    16.325790499025057,    -80.79982615022392,
        109.36883031524195,    3709.200344072255,     -38475.11174050737,
        189542.64493523433,    -541195.7993319352,    911711.4803674042,
        -842390.4410697503,    329949.62974702445,    -66686.40756350016,
        412318.7421915861,     -1527988.4787667112,   1979916.9286728422,
        -3351299.964018562,    9675332.711986123}},
      {"PTE",
       {0.001160026763267757,  -0.004272519451960154, 0.008131053404646165,
        -0.012997852465693517, 0.018770774767698756,  -0.035982204034513764,
        0.043294928600738816,  -0.17858052943220215,  0.07924484363037265,
        -2.280230302269953,    9.299762933296362,     -46.02686552344747,
        62.30031875641819,     2112.9664136184006,    -21917.62665725075,
        107974.66076000725,    -308297.60885986226,   519366.1305907443,
        -479876.8901433595,    187959.4155563584,     -37988.50779837247,
        234880.62465473608,    -870430.1171371285,    1127874.2514611264,
        -1909092.2007334938,   5511622.900780279}}};

  std::unordered_map<std::string, Eigen::Matrix<double, Eigen::Dynamic,
  Eigen::Dynamic>> alpha_exp = {
      {"H",
       {0.00026975195853437756, -0.000993620329417148, 0.001891218910438199,
        -0.0030238143579798577, 0.004367484462405188,  -0.008373634478968167,
        0.010075398473345949,   -0.041564761065610294, 0.018439562137764844,
        -0.5307518055723501,    2.164620841047454,     -10.711715515679263,
        14.465017589228784,     492.244513804492,      -5104.556831686957,
        25145.171580040453,     -71794.34400650057,    120944.95072648925,
        -111748.30572219027,    43769.70809127443,     -8846.294063174388,
        54696.20529096775,      -202695.55833637537,   262646.20713514875,
        -444567.2608538437,     1283482.8929905395}},
      {"F",
       {0.0006071239014153265,  -0.0022365701571267185, 0.004257667307667859,
        -0.0068092218983490495, 0.00983684265891101,    -0.01886583672421765,
        0.022699258707042872,   -0.0936770705916146,    0.041535910994797164,
        -1.1963407684362022,    4.87913608293825,       -24.13918734144171,
        32.48067054886879,      1110.9781044079969,     -11515.71460007509,
        56719.91229678004,      -161937.94203505144,    272793.5876197095,
        -252046.25535453352,    98720.73845827903,      -19951.927353633484,
        123361.43038519447,     -457157.77540065243,    592369.7865532706,
        -1002672.5952890929,    2894754.5247435574}},
      {"Cl",
       {0.0012200832409884313, -0.004494294652753245, 0.0085547489302649,
        -0.013679274551348711, 0.019759649275011677,  -0.03788891361915817,
        0.045591567311302046,  -0.18808893301789936,  0.08345189437934655,
        -2.401762048860039,    9.795401271319717,     -48.47645973969995,
        65.53866402640995,     2226.5655556278757,    -23092.70358557595,
        113759.52672757796,    -324810.6827266871,    547181.3764495568,
        -505576.0264617392,    198025.14848874576,    -40023.051432752894,
        247460.58884679433,    -917050.0861062903,    1188283.1695674597,
        -2011343.642800773,    5806826.942623355}},
      {"Br",
       {0.0015255538683998792, -0.0056189392791928154, 0.01069382782604773,
        -0.01709537707625336,  0.024688983140316884,   -0.04732808112437644,
        0.056946793590633225,  -0.23489373764040797,   0.10423237090772046,
        -2.999283619280589,    12.232363784447381,     -60.54020614050264,
        81.9228437559967,      2779.5898260446384,     -28831.61773319148,
        142034.9956377259,     -405549.3878793884,     683200.057238456,
        -631255.1660672569,    247252.1305881668,      -49972.72825702882,
        308979.26872454176,    -1145028.985079031,     1483690.8492807986,
        -2511364.7461204557,   7250407.309886192}},
      {"I", {0.0020002489737841076, -0.007367840819104805, 0.014023642092494825,
             -0.02242220311843911,  0.03238626515603374,   -0.06209637553244475,
             0.0747179327252164,    -0.3082528270614372,   0.13676227429867885,
             -3.9362168778942643,   16.053619319243463,    -79.44972880635781,
             107.45876267365159,    3648.525611746699,     -37842.42947545905,
             186422.30450316027,    -532283.3415855,       896695.8373280053,
             -828516.3009018041,    324515.46344431036,    -65588.29930645236,
             405529.43058860424,    -1502828.579135274,    1947315.6639344753,
             -3296117.687535335,    9516019.393588386}},
      {"CTE",
       {0.0010886439106782989, -0.004009498503357391, 0.007630197625734075,
        -0.01219654487719686,  0.017612900038531134,  -0.033761356201936724,
        0.04062287208534222,   -0.1675530286444572,   0.07435483912085955,
        -2.139392602607009,    8.72535542043753,      -43.18426783542821,
        58.45990664987887,     1982.3611343398527,    -20563.177743382574,
        101302.5348930453,     -289247.3913306977,    487274.22487097594,
        -450225.44414834393,   176345.5871430584,     -35641.361105612144,
        220368.58131123398,    -816651.0773327281,    1058189.3139119563,
        -1791140.483520341,    5171091.824320406}},
      {"CTR",
       {0.0010886439106782989, -0.004009498503357391, 0.007630197625734075,
        -0.01219654487719686,  0.017612900038531134,  -0.033761356201936724,
        0.04062287208534222,   -0.1675530286444572,   0.07435483912085955,
        -2.139392602607009,    8.72535542043753,      -43.18426783542821,
        58.45990664987887,     1982.3611343398527,    -20563.177743382574,
        101302.5348930453,     -289247.3913306977,    487274.22487097594,
        -450225.44414834393,   176345.5871430584,     -35641.361105612144,
        220368.58131123398,    -816651.0773327281,    1058189.3139119563,
        -1791140.483520341,    5171091.824320406}},
      {"CBR",
       {0.0010886439106782989, -0.004009498503357391, 0.007630197625734075,
        -0.01219654487719686,  0.017612900038531134,  -0.033761356201936724,
        0.04062287208534222,   -0.1675530286444572,   0.07435483912085955,
        -2.139392602607009,    8.72535542043753,      -43.18426783542821,
        58.45990664987887,     1982.3611343398527,    -20563.177743382574,
        101302.5348930453,     -289247.3913306977,    487274.22487097594,
        -450225.44414834393,   176345.5871430584,     -35641.361105612144,
        220368.58131123398,    -816651.0773327281,    1058189.3139119563,
        -1791140.483520341,    5171091.824320406}},
      {"CDI",
       {0.0010886439106782989, -0.004009498503357391, 0.007630197625734075,
        -0.01219654487719686,  0.017612900038531134,  -0.033761356201936724,
        0.04062287208534222,   -0.1675530286444572,   0.07435483912085955,
        -2.139392602607009,    8.72535542043753,      -43.18426783542821,
        58.45990664987887,     1982.3611343398527,    -20563.177743382574,
        101302.5348930453,     -289247.3913306977,    487274.22487097594,
        -450225.44414834393,   176345.5871430584,     -35641.361105612144,
        220368.58131123398,    -816651.0773327281,    1058189.3139119563,
        -1791140.483520341,    5171091.824320406}},
      {"NTE",
       {0.0007515319904944638, -0.0027681506325821555, 0.005268518376946641,
        -0.008422934300160369, 0.012164874547481885,   -0.02332153158337927,
        0.02806079082261381,   -0.11575622389159826,   0.0513548089691563,
        -1.4781007908372756,   6.028269207576228,      -29.83009892925989,
        40.254883866386976,    1371.241013256491,      -14218.634392792103,
        70040.28074204552,     -199977.93116343883,    336883.484312244,
        -311267.37312289205,   121917.80534540737,     -24641.107889213068,
        152355.28128051144,    -564605.3797869289,     731597.2995687138,
        -1238336.3053245454,   3575125.024000381}},
      {"NTR2",
       {0.0007515319904944638, -0.0027681506325821555, 0.005268518376946641,
        -0.008422934300160369, 0.012164874547481885,   -0.02332153158337927,
        0.02806079082261381,   -0.11575622389159826,   0.0513548089691563,
        -1.4781007908372756,   6.028269207576228,      -29.83009892925989,
        40.254883866386976,    1371.241013256491,      -14218.634392792103,
        70040.28074204552,     -199977.93116343883,    336883.484312244,
        -311267.37312289205,   121917.80534540737,     -24641.107889213068,
        152355.28128051144,    -564605.3797869289,     731597.2995687138,
        -1238336.3053245454,   3575125.024000381}},
      {"NPI2",
       {0.0007515319904944638, -0.0027681506325821555, 0.005268518376946641,
        -0.008422934300160369, 0.012164874547481885,   -0.02332153158337927,
        0.02806079082261381,   -0.11575622389159826,   0.0513548089691563,
        -1.4781007908372756,   6.028269207576228,      -29.83009892925989,
        40.254883866386976,    1371.241013256491,      -14218.634392792103,
        70040.28074204552,     -199977.93116343883,    336883.484312244,
        -311267.37312289205,   121917.80534540737,     -24641.107889213068,
        152355.28128051144,    -564605.3797869289,     731597.2995687138,
        -1238336.3053245454,   3575125.024000381}},
      {"NDI",
       {0.0007515319904944638, -0.0027681506325821555, 0.005268518376946641,
        -0.008422934300160369, 0.012164874547481885,   -0.02332153158337927,
        0.02806079082261381,   -0.11575622389159826,   0.0513548089691563,
        -1.4781007908372756,   6.028269207576228,      -29.83009892925989,
        40.254883866386976,    1371.241013256491,      -14218.634392792103,
        70040.28074204552,     -199977.93116343883,    336883.484312244,
        -311267.37312289205,   121917.80534540737,     -24641.107889213068,
        152355.28128051144,    -564605.3797869289,     731597.2995687138,
        -1238336.3053245454,   3575125.024000381}},
      {"OTE",
       {0.0006946853489006533,  -0.0025588408443880813, 0.004870348164283877,
        -0.0077869249509840005, 0.011246893120347849,   -0.021563672080108565,
        0.025945555302880043,   -0.1070427836020098,    0.04748404245779408,
        -1.3668991790965312,    5.574790820190554,      -27.587495129812886,
        37.26686102012461,      1267.5350957607914,     -13144.758843985801,
        64751.70360680213,      -184878.4922919444,     311446.05043672066,
        -287762.9229630067,     112711.02297453291,     -22779.703580832185,
        140845.30421622912,     -521950.0345517912,     676325.3221457086,
        -1144779.4386287914,    3305022.3997088675}},
      {"OTR4",
       {0.000695268212212719,  -0.0025608224009820916, 0.004873689439449516,
        -0.007791173981749128, 0.011251934463215244,   -0.02156982988977673,
        0.02595362311847396,   -0.10705452685536404,   0.04750435103604901,
        -1.366947792576134,    5.57498644799207,       -27.590829937661752,
        37.314663487014805,    1267.1169878606543,     -13142.491883315517,
        64743.911332144104,    -184861.49367630074,    311423.24559236557,
        -287745.751056988,     112705.46086780752,     -22779.477779034987,
        140845.0628561359,     -521950.4469882243,     676326.5064031361,
        -1144782.4619407712,   3305031.485769615}},
      {"OPI2",
       {0.000695268212212719,  -0.0025608224009820916, 0.004873689439449516,
        -0.007791173981749128, 0.011251934463215244,   -0.02156982988977673,
        0.02595362311847396,   -0.10705452685536404,   0.04750435103604901,
        -1.366947792576134,    5.57498644799207,       -27.590829937661752,
        37.314663487014805,    1267.1169878606543,     -13142.491883315517,
        64743.911332144104,    -184861.49367630074,    311423.24559236557,
        -287745.751056988,     112705.46086780752,     -22779.477779034987,
        140845.0628561359,     -521950.4469882243,     676326.5064031361,
        -1144782.4619407712,   3305031.485769615}},
      {"STE",
       {0.0013647669370300433, -0.005027392668863502, 0.009569823288603346,
        -0.015303422525251227, 0.022106726626048876,  -0.0423938469951198,
        0.051010980532191885,  -0.21047898361249165,  0.09336212500678213,
        -2.6878182854161463,   10.962032408117638,    -54.24442498366381,
        73.219361521211,       2493.172972103125,     -25852.619475811185,
        127348.30375031357,    -363600.61233171757,   612518.7945846696,
        -565940.4064287504,    221667.46532065296,    -44800.6472713504,
        276999.5687520479,     -1026516.2864034787,   1330125.5718862645,
        -2251432.318005995,    6499972.106011955}},
      {"STR4",
       {0.0013647669370300433, -0.005027392668863502, 0.009569823288603346,
        -0.015303422525251227, 0.022106726626048876,  -0.0423938469951198,
        0.051010980532191885,  -0.21047898361249165,  0.09336212500678213,
        -2.6878182854161463,   10.962032408117638,    -54.24442498366381,
        73.219361521211,       2493.172972103125,     -25852.619475811185,
        127348.30375031357,    -363600.61233171757,   612518.7945846696,
        -565940.4064287504,    221667.46532065296,    -44800.6472713504,
        276999.5687520479,     -1026516.2864034787,   1330125.5718862645,
        -2251432.318005995,    6499972.106011955}},
      {"SPI2",
       {0.0013647669370300433, -0.005027392668863502, 0.009569823288603346,
        -0.015303422525251227, 0.022106726626048876,  -0.0423938469951198,
        0.051010980532191885,  -0.21047898361249165,  0.09336212500678213,
        -2.6878182854161463,   10.962032408117638,    -54.24442498366381,
        73.219361521211,       2493.172972103125,     -25852.619475811185,
        127348.30375031357,    -363600.61233171757,   612518.7945846696,
        -565940.4064287504,    221667.46532065296,    -44800.6472713504,
        276999.5687520479,     -1026516.2864034787,   1330125.5718862645,
        -2251432.318005995,    6499972.106011955}},
      {"PTE",
       {0.0013647669370300433, -0.005027392668863502, 0.009569823288603346,
        -0.015303422525251227, 0.022106726626048876,  -0.0423938469951198,
        0.051010980532191885,  -0.21047898361249165,  0.09336212500678213,
        -2.6878182854161463,   10.962032408117638,    -54.24442498366381,
        73.219361521211,       2493.172972103125,     -25852.619475811185,
        127348.30375031357,    -363600.61233171757,   612518.7945846696,
        -565940.4064287504,    221667.46532065296,    -44800.6472713504,
        276999.5687520479,     -1026516.2864034787,   1330125.5718862645,
        -2251432.318005995,    6499972.106011955}}};

  std::unordered_map<std::string, Eigen::Matrix<double, Eigen::Dynamic,
  Eigen::Dynamic>> alpha_m1 = {
      {"H",
       {0.00015227534391471046, -0.000560859433090699, 0.001067403581135526,
        -0.0017064094213278533, 0.002464436996597555,  -0.004724768488889933,
        0.0056849420999926506,  -0.02345279895055153,  0.010404974809457014,
        -0.29947695310398226,   1.2213931643913045,    -6.044401407391797,
        8.168337412688796,      277.67726458079306,    -2879.768531727025,
        14186.175135933247,     -40504.7525002491,     68234.85438461207,
        -63046.52974730629,     24694.203666493802,    -4990.980014836407,
        30859.016305494202,     -114358.70559071748,   148182.24728560445,
        -250820.22974332364,    724127.7218574472}},
      {"F",
       {0.0006571091726511812, -0.0024204014516902438, 0.004606800038947348,
        -0.007365460854785391, 0.010638172594380402,   -0.020396124386865205,
        0.024541497107955924,  -0.10124280496069703,   0.04491792535127828,
        -1.29279224657956,     5.272531989117367,      -26.09175917330089,
        35.239262220721166,    1198.9659025132753,     -12433.517729664136,
        61248.37806192316,     -174876.95953135937,    294599.2766513616,
        -272198.65394887456,   106615.28049294182,     -21548.11518910654,
        133231.0043277217,     -493733.2486566007,     639763.2477764762,
        -1082893.2371852917,   3126354.7076811544}},
      {"Cl",
       {0.0016575649670497533, -0.0061049912181043746, 0.011618339030501416,
        -0.018572436194977088, 0.0268211698967941,     -0.05141649171655029,
        0.061864327939878255,  -0.2551994072691,       0.11322234461335692,
        -3.258661880906541,    13.290137287231918,     -65.76743014151346,
        88.81715446069447,     3022.244701585258,      -31340.953701043043,
        154387.3245977231,     -440807.80615451105,    742588.6136085144,
        -686124.0476582566,    268742.4304279415,      -54315.93511994882,
        335833.2518812743,     -1244545.8812692505,    1612641.6923659574,
        -2729633.208007499,    7880556.8942977935}},
      {"Br",
       {0.0022760875325706347, -0.008384356589657797, 0.015959841766939983,
        -0.025521515615669628, 0.036867032858565296,  -0.07069594973382458,
        0.08506732676853004,   -0.35097038597501373,  0.15570329435709723,
        -4.481753149111177,    18.278464074231447,    -90.45396074613842,
        122.19153313815953,    4156.115160970137,     -43100.752960076476,
        212318.40927033222,    -606214.694673869,     1021235.6108577332,
        -943583.9038248026,    369584.9098224879,     -74697.39709843225,
        461851.0832653731,     -1711548.4862545056,   2217768.381724798,
        -3753899.187820128,    10837652.512024676}},
      {"I", {0.003559553742633863, -0.0131117991020962, 0.024957284124543358,
             -0.0399050317452076,  0.05763895423091862, -0.11051366252723062,
             0.13297579217113342,  -0.5485877089079273, 0.24338871016115907,
             -7.005112093289552,   28.569859906236967,  -141.39018788456988,
             191.18335963533335,   6493.691479514398,   -67349.97600458574,
             331780.7803996014,    -947313.0455534956,  1595857.2349008007,
             -1474513.24818461,    577539.9921264868,   -116726.49692807019,
             721713.3343511844,    -2674555.2469758503, 3465599.7133214106,
             -5866035.2891271,     16935470.637781154}},
      {"CTE",
       {0.0010859148574911808, -0.003999801700378642, 0.007612703449975616,
        -0.012171012399920583, 0.017578496455621855,  -0.033702526726349345,
        0.04055076606085444,   -0.167297524525131,    0.07421059420756027,
        -2.136322601460952,    8.712772991052963,     -43.11293491834307,
        58.157405330848604,    1982.1541881209907,    -20552.355914985877,
        101238.7566000549,     -289054.26852415904,   486941.23366650863,
        -449914.9478395627,    176223.6368437987,     -35617.203114311225,
        220220.63221053622,    -816104.5716794255,    1057482.0751562836,
        -1789944.817878523,    5167640.401033693}},
      {"CTR",
       {0.0011189252114368648, -0.004121240613669159, 0.007843385360787802,
        -0.01253853678503875,  0.018107804283484595,  -0.034713413741104815,
        0.0417669497902485,    -0.17229838251839516,  0.07644124440698787,
        -2.200118660394404,    8.973024265107695,     -44.406379418211735,
        60.0343743859799,      2039.628538656364,     -21153.771064712848,
        104207.59833023348,    -297536.94396564993,   501234.68391141854,
        -463122.25915033184,   181396.5513684912,     -36662.056814598356,
        226679.5082762993,     -840038.4377394788,    1088493.9139048357,
        -1842435.5169463255,   5319182.588216057}},
      {"CBR",
       {0.0011615421237523484, -0.004278793520733144, 0.008144953523157047,
        -0.013025117225566363, 0.018815969820611216,  -0.03608292667989356,
        0.04341840543275379,   -0.17914059406129643,  0.07947194784487221,
        -2.287574548899983,    9.32971173902593,      -46.17103547126976,
        62.413831371886644,    2120.725353095546,     -21994.41709059443,
        108347.60460490544,    -309355.0975391613,    521140.2670438986,
        -481511.65927340294,   188598.48865913224,    -38116.8693328785,
        235673.4270691923,     -873367.1962919233,    1131679.5681105205,
        -1915532.5496335686,   5530216.188931374}},
      {"CDI",
       {0.0010529477308310919, -0.00387851535494413, 0.007382265086108502,
        -0.011802988433444227, 0.01704735982379651,  -0.03268164489379742,
        0.03932468758418705,   -0.16220868075853062, 0.07198240200502902,
        -2.0711974693101913,   8.447268608993099,    -41.809445830544114,
        56.62962426596538,     1918.8189339423884,   -19905.462975146856,
        98064.49269532743,     -280004.95708397654,  471707.4367054557,
        -435844.36314433574,   170713.38527945566,   -34503.499746965244,
        213333.83804897114,    -790582.0870916704,   1024410.3024964908,
        -1733965.0474193343,   5006024.298622261}},
      {"NTE",
       {0.0009406398721279135, -0.003465192918207485, 0.006596558239315318,
        -0.01054964643361545,  0.015240340767477953,  -0.0292272545294243,
        0.03516730183542278,   -0.14511222479613373,  0.06435766497966167,
        -1.853120902062223,    7.557758414540454,     -37.3953210465567,
        50.39929218247775,     1719.898589234681,     -17830.981290586,
        87830.1640426852,      -250765.17684846415,   422433.5372143253,
        -390308.3670642995,    152875.60704683515,    -30897.274368518025,
        191036.0568635263,     -707949.3983375478,    917337.3168456672,
        -1552727.889910854,    4482785.469946399}},
      {"NTR2",
       {0.0008970193171392277, -0.0033042122944437944, 0.0062892826418021784,
        -0.010056276356283424, 0.014525441411992268,   -0.027852037910813456,
        0.03351214734092646,   -0.13826956521394806,   0.06133266688819859,
        -1.7656904671857774,   7.201224655312433,      -35.63503855564594,
        48.11275269025326,     1637.670882380105,      -16982.15000545439,
        83653.69040700572,     -238846.15528627494,    402359.2673524084,
        -371762.752377534,     145612.11772771477,     -29429.3708707219,
        181960.0152457949,     -674314.922274788,      873754.8324426343,
        -1478958.0788893087,   4269809.1517106425}},
      {"NPI2",
       {0.0010038886789630103, -0.0036974672356715438, 0.007036708238823325,
        -0.011248495791396383, 0.0162443812087269,     -0.031139231019407274,
        0.0374677157841343,    -0.15454528213043478,   0.06857944510879113,
        -1.973333885296366,    8.048107731543938,      -39.83224721198642,
        53.91972610647086,     1828.518424719694,      -18967.226820456275,
        93439.97121756503,     -266797.0316294377,     449453.02761984157,
        -415279.3549438785,    162657.62194255236,     -32874.69566871407,
        203262.15741010397,    -753257.0391387071,     976045.253430339,
        -1652099.3448557795,   4769674.581471931}},
      {"NDI",
       {0.0007766573953081371, -0.0028608012097425493, 0.005445153439307375,
        -0.008706277756291788, 0.012575317054946175,   -0.024112177225865578,
        0.0290130440201337,    -0.11969960147179315,   0.05310435215204098,
        -1.528519016506211,    6.233974222649905,      -30.85176757011328,
        41.72249369344322,     1416.865521234118,      -14695.442865575116,
        72393.47519925426,     -206701.45547398762,    348213.3313501658,
        -321737.07167307264,   126018.80863880104,     -25469.872687015493,
        157479.14073888058,    -583593.1616416735,     756200.8173934869,
        -1279981.0187122494,   3695354.7996752393}},
      {"OTE",
       {0.0009418679572955038, -0.0034692211395843217, 0.006602865533715767,
        -0.010555947186749588, 0.015245305259427588,   -0.02922409767757871,
        0.035164766082599774,  -0.14503291380759203,   0.06437148092185348,
        -1.85180812133294,     7.552509470805859,      -37.38339461165591,
        50.68987309254095,     1714.8813268403758,     -17792.230407735045,
        87656.67926208499,     -250290.94339297686,    421652.9643017421,
        -389596.8884053439,    152599.29374422008,     -30842.471918851676,
        190697.7640426635,     -706696.1905245336,     915713.6489928218,
        -1549979.8779736764,   4474851.947079629}},
      {"OTR4",
       {0.0008728469850726618, -0.0032149320961310734, 0.006118675101584914,
        -0.009781873047052525, 0.014127322138301196,   -0.027084787729473543,
        0.03258851709469388,   -0.13444439121288415,   0.05964147425987893,
        -1.71678086510023,     7.001724602815359,      -34.64764912012309,
        46.77324019678921,     1592.4042622677234,     -16512.521541849623,
        81340.17251370627,     -232240.74372734205,    391232.1720571733,
        -361482.1455279709,    141585.5365476981,      -28615.69090398819,
        176929.2289043383,     -655671.7587719086,     849597.6961959262,
        -1438068.6570988651,   4151759.830671329}},
      {"OPI2",
       {0.000885410274273837,  -0.0032612972640866313, 0.006207194142878338,
        -0.009924063729684842, 0.014333436096715824,   -0.02748123070601218,
        0.03306558775963014,   -0.1364159317351573,    0.0605121538426924,
        -1.741967664473719,    7.104418368431187,      -35.15375765426491,
        47.40954779873732,     1616.360840197196,      -16758.943758019166,
        82551.53451998367,     -235696.53993120667,    397051.4992831589,
        -366857.84763094527,   143690.8535675066,      -29041.131881800193,
        179559.74348246047,    -665420.0927353266,     862229.2982338897,
        -1459449.5528853538,   4213487.324786436}},
      {"STE",
       {0.0015517534860543965, -0.005715957854040494, 0.010879908146298422,
        -0.01739655154227782,  0.025128191633514766,  -0.04818071380323834,
        0.057974086310372694,  -0.2391724837402962,   0.10611324019853001,
        -3.05408808036208,     12.455925230006091,    -61.645767991128494,
        83.41090527464522,     2830.3982380865577,    -29358.126090121285,
        144627.642034945,      -412950.1527080365,    695665.4244678826,
        -642771.4183830095,    251762.49565875228,    -50884.18945816273,
        314614.86212307424,    -1165913.76796935,     1510752.7518836013,
        -2557171.1432755566,   7382652.2089194255}},
      {"STR4", {0.00198213822667585, -0.0073009074567373,  0.013895601563780242,
                -0.0222158051224241, 0.032086089212083564, -0.06151594094438555,
                0.0740174438426816,  -0.30535095533569734, 0.13547008615550607,
                -3.8991320721261884, 15.902344633675948,   -78.69917359163146,
                106.40087791125629,  3614.718458824722,    -37490.16331248755,
                184685.79936487702,  -527325.891194797,    888347.7066235633,
                -820806.5336820668,  321497.11315203184,   -64979.997561563214,
                401771.411830246,    -1488905.6684719285,  1929276.7047083091,
                -3265587.0999398916, 9427877.467418801}},
      {"SPI2",
       {0.0014211056406047697, -0.00523454449338537, 0.009963139568482712,
        -0.01592971438432771,  0.02300849842186622,  -0.04411434581188551,
        0.053081790291549275,  -0.21897804202496032, 0.09716486799669606,
        -2.796158371781012,    11.403965564662043,   -56.44072536400656,
        76.38490387078012,     2591.2304490789297,   -26878.255100126753,
        132412.6052194656,     -378075.58193645085,  636917.7063554253,
        -588492.254364778,     230502.7593231881,    -46587.58850770784,
        288049.25754996674,    -1067465.8245276897,  1383187.160695467,
        -2341247.6477966723,   6759272.714044204}},
      {"PTE",
       {0.0010816945937020769, -0.003984648780738148, 0.007584930392916109,
        -0.012129224823341367, 0.017520946152626407,  -0.033599210786897434,
        0.04042631938827707,   -0.16681646653299959,  0.07397579135583958,
        -2.130322257880156,    8.688305198794259,     -42.988956291737566,
        57.94825837745723,     1976.8964322100198,    -20495.417611085173,
        100952.94395071449,    -288227.78665237443,   485535.3705341952,
        -448605.86432745575,   175707.62769779057,    -35510.005442505346,
        219553.67872393745,    -813628.1641536903,    1054270.8385733634,
        -1784505.571783275,    5151935.765373088}}};

  std::unordered_map<std::string, Eigen::Matrix<double, Eigen::Dynamic,
  Eigen::Dynamic>> alpha_m2 = {
      {"H",
       {0.0002284591402997886, -0.0008414821121140717, 0.0016015201093649723,
        -0.002560258998795895, 0.0036974889839234927,  -0.00708811566931536,
        0.008528462710082736,  -0.035180358816633686,  0.015608990925286769,
        -0.44921887075916667,  1.8321089147150051,     -9.067230310431187,
        12.266844470833577,    416.3360574322252,      -4318.336084958029,
        21273.379229325365,    -60740.87290504631,     102325.1748433576,
        -94544.78240138428,    37031.48697359342,      -7484.429580573536,
        46275.80637622385,     -171490.80885814028,    222212.08752255118,
        -376126.5208186193,    1085891.8069321276}},
      {"F",
       {0.000769671510916844,  -0.0028349431316992886, 0.005395621036088875,
        -0.008626161409589089, 0.012458579331131486,   -0.023884556224391482,
        0.02873923988860575,   -0.11854828817278118,   0.05260288011586299,
        -1.513716471940155,    6.173552513720499,      -30.551869823592966,
        41.2876643013429,      1403.5922586426404,     -14556.744298300211,
        71709.67085632414,     -204749.78901551873,    344927.74578877195,
        -318703.4751717109,    124831.39832746817,     -25230.707521669246,
        156001.6526617135,     -578119.2787708754,     749108.66878124,
        -1267977.6599828391,   3660701.040353}},
      {"Cl",
       {0.0017022894597240688, -0.006270476747070499, 0.011935373017466219,
        -0.019084120806013103, 0.027565394698659575,  -0.05285427585227899,
        0.06359551861365244,   -0.26238063231713704,  0.11639068598895355,
        -3.3505340404542614,   13.664925955730746,    -67.62427736792438,
        91.39830254799324,     3106.330277681107,     -32215.619215815062,
        158697.9328119378,     -453115.3639393301,    763319.419893346,
        -705275.6979869893,    276242.7303473113,     -55830.82113181781,
        345198.4046202792,     -1279250.2303704761,   1657609.7360707389,
        -2805747.125978046,    8100300.338461353}},
      {"Br", {0.0022183744588643024, -0.00817191005065554, 0.015555727256266945,
              -0.024875070219600188, 0.03593223910379454,  -0.06889918335019252,
              0.08290293272706917,   -0.34202951400240106, 0.15172778385433633,
              -4.367559468188562,    17.812705062921122,   -88.14714085038675,
              119.05097524027907,    4050.347882204189,    -42002.40687444492,
              206904.3869894881,     -590749.6427766937,   995174.1463824734,
              -919497.5187313334,    360148.612063249,     -72788.41183407987,
              450045.42178285983,    -1667795.7008409041,  2161073.542558951,
              -3657932.607604678,    10560592.489894014}},
      {"I", {0.003598782610171026, -0.013257053877487632, 0.02523593484981538,
             -0.04035658817861964, 0.058297823817256324,  -0.11179541456528908,
             0.13451639983388416,  -0.5550376476001154,   0.24617716524403002,
             -7.087867593971898,   28.90708733816146,     -143.03111941148413,
             192.76139975757619,   6578.621515112056,     -68203.8820791909,
             335954.8269535605,    -959196.7200630999,    1615852.770444588,
             -1492979.4525414815,  584771.7536016583,     -118189.50621264888,
             730763.2067522402,    -2708097.873459852,    3509065.820274789,
             -5939612.336299378,   17147891.942733616}},
      {"CTE",
       {0.0009062631108006921, -0.0033382326032417795, 0.006353959236417055,
        -0.010159388088155434, 0.014674023377850055,   -0.02813540233329174,
        0.033853284646737994,  -0.1396675816061073,    0.061958915372687336,
        -1.7835013965340594,   7.273873149730658,      -35.99598518242857,
        48.62986950877222,     1653.8379275973853,     -17151.126870511478,
        84487.93772532837,     -241230.55405646187,    406378.3730175493,
        -375477.60865238874,   147067.517626221,       -29723.724035517313,
        183780.13343122872,    -681060.1064934462,     882495.0609026368,
        -1493752.246902244,    4312520.49959278}},
      {"CTR",
       {0.0010412827203435111, -0.0038352826963584004, 0.007299272625208903,
        -0.011669048449793194, 0.0168528926322048,     -0.03230813497655479,
        0.038876007327235534,  -0.16035478915250595,   0.07116661795518993,
        -2.047498689986666,    8.350617300962117,      -41.33241921878746,
        56.01141533033066,     1896.526327155356,      -19675.42451502338,
        96932.82766869297,     -276775.672731631,      466268.9548871665,
        -430820.2388586788,    168745.71854272252,     -34105.870792549205,
        210875.28086786342,    -781470.9901339042,     1012604.4047922485,
        -1713981.7667430474,   4948331.769754755}},
      {"CBR",
       {0.0011862695791836667, -0.004369721757266276, 0.008317544710257599,
        -0.013299664443005375, 0.019210719420169015,  -0.036835522784451916,
        0.04432286569708426,   -0.18286005399868413,  0.0811265890784289,
        -2.3350327336824397,   9.523275042062313,     -47.129938235461324,
        63.72619057212376,     2164.5789932101547,    -22450.08991694234,
        110594.0074571056,     -315772.130922334,     531954.2476733804,
        -491506.093191306,     192513.9820595423,     -38908.94403963711,
        240571.70407704072,    -891520.4451626976,    1155202.4358233986,
        -1955349.2062034896,   5645168.676708794}},
      {"CDI",
       {0.0009329882708681281, -0.0034365044712478944, 0.0065405576598754804,
        -0.010456842731575442, 0.015102890187754804,   -0.028956373688727624,
        0.03484194043135244,   -0.14373789604699186,   0.0637764552917509,
        -1.8354356955791369,   7.485736107110416,      -37.04911086277592,
        50.15739651959971,     1700.6805197349759,     -17641.400568140285,
        86908.8208846137,      -248149.4483944024,     418039.6704218638,
        -386255.106101038,     151289.54167495517,     -30577.298989747782,
        189057.82340255068,    -700618.4334570772,     907838.104214217,
        -1536649.0754936205,   4436365.305509728}},
      {"NTE",
       {0.0008707915985155423, -0.0032075853656457374, 0.006105313228052201,
        -0.009761920596576648, 0.01410005619359511,    -0.027035409106859927,
        0.03252972699343216,   -0.1342095094579334,    0.059535527425430106,
        -1.7138144022831627,   6.989659707288872,      -34.5893035695707,
        46.72923423987422,     1589.1797712465884,     -16480.472484718455,
        81183.71733560786,     -231795.05241163436,    390481.46995316,
        -360788.0982419428,    141313.45355152106,     -28560.361259285153,
        176586.54078045647,    -654401.1199255278,     847950.8980538945,
        -1435280.6648161015,   4143710.597703588}},
      {"NTR2",
       {0.0009564374204041779, -0.0035232159718411524, 0.006706531933454731,
        -0.010724107179878038, 0.015490784528059031,   -0.029702698771007247,
        0.035740088112752484,  -0.14744919878705254,   0.06541568359389038,
        -1.8828473933068368,   7.679055245336658,      -38.0024545608289,
        51.37308595660673,     1745.529908448901,      -18103.356025837948,
        89180.2203885544,      -254629.4436710477,     428951.06808933406,
        -396334.0923841475,    155236.5931514409,      -31374.65489832219,
        193987.50437093555,    -718886.7181566942,     931509.3809783326,
        -1576715.9362450228,   4552039.796994236}},
      {"NPI2",
       {0.0009589128936563368, -0.00353194132411159, 0.006722003217161658,
        -0.010746194379205013, 0.015519596696496918, -0.02975251867400998,
        0.03579752075659584,   -0.14767960317571724, 0.06551064096164426,
        -1.885782445615467,    7.690977400029957,    -38.057892046456956,
        51.36747824253197,     1749.2704617792458,   -18138.726266969214,
        89350.1928829637,      -255109.9589102952,   429756.79756867886,
        -397076.817626625,     155527.15338009057,   -31433.34235674293,
        194350.54372035598,    -720232.3260783714,   933253.1005497305,
        -1579667.6381597645,   4560561.545927916}},
      {"NDI",
       {0.0007939971756493206, -0.002924588938549364, 0.005566366784569978,
        -0.00889985155052511,  0.012854725569088378,  -0.02464837157431863,
        0.029657698730726587,  -0.1223656326566655,   0.05428044505696793,
        -1.562594084657632,    6.372939329343971,     -31.53834375411319,
        42.635223673414444,    1448.5497758284548,    -15023.099003364438,
        74005.30866361884,     -211298.99950046107,   355952.2709433593,
        -328882.9185340016,    128816.19460733952,    -26033.88865798197,
        160964.45424583272,    -596506.9121506559,    772932.8899281267,
        -1308300.7148337483,   3777114.227430117}},
      {"OTE",
       {0.0009683482864155142, -0.0035672892976514347, 0.006791016484922783,
        -0.010861046307225699, 0.015690961575882928,   -0.030092925371645516,
        0.03621086854181278,   -0.14941433765179435,   0.06627975452548013,
        -1.9080284748329408,   7.781762751305724,      -38.50939411277064,
        52.02639474751409,     1769.3013859173268,     -18348.586245698156,
        90386.81459960595,     -258073.2559565748,     434751.96169380867,
        -401693.9174013259,    157336.0336187491,      -31799.16877912569,
        196612.6021113071,     -728615.31534203,       944115.5708908426,
        -1598054.0658506476,   4613643.908688357}},
      {"OTR4",
       {0.0008951668322393613, -0.003297575421595692, 0.006277198934097713,
        -0.010038161084288098, 0.014500759742812962,  -0.027806418349502503,
        0.03345897359933599,   -0.13804332973332606,  0.06124119144054229,
        -1.762754763471606,    7.189262756947294,     -35.57803557695437,
        48.083721317847775,    1634.3513150242713,    -16949.7954317197,
        83496.99972694513,     -238401.9907239259,    401613.77462088474,
        -371075.3792655935,    145343.2259755615,     -29375.15997211148,
        181624.85502912392,    -673072.8418031019,    872145.3579511875,
        -1476233.748514033,    4261943.879748651}},
      {"OPI2",
       {0.0009058042990581663, -0.0033358924918660137, 0.006347727093412692,
        -0.010145236322248494, 0.014649059152223818,   -0.028077401181790373,
        0.03378256700288381,   -0.13933682738465153,   0.06183185664065538,
        -1.7791153218784397,   7.255979213365129,      -35.91082185612945,
        48.5843211806063,      1648.9444652333286,     -17103.496935909447,
        84257.77741870162,     -240579.517512823,      405287.7513241834,
        -374473.6956304027,    146675.36876016966,     -29645.224404551176,
        183295.74315070428,    -679266.1608831539,     880171.095652013,
        -1489819.499492887,    4301166.826512304}},
      {"STE",
       {0.0015547758538555782, -0.005726601237180419, 0.010898675525059832,
        -0.017422628244716055, 0.025160892764742208,  -0.04823366312513407,
        0.05803346668647447,   -0.23940338076649612,  0.10620649532306095,
        -3.0570156974459364,   12.467819349121672,    -61.70144523066041,
        83.42646515060069,     2833.7422048119242,    -29389.888352984588,
        144779.05581902363,    -413374.0141372087,    696369.3906680399,
        -643414.7037374064,    252012.21542552242,    -50932.72873005428,
        314912.2623173018,     -1167012.7798599417,   1512175.2678196724,
        -2559576.5324115753,   7389595.807288468}},
      {"STR4",
       {0.0022927224004560855, -0.008445688568862625, 0.016076587250340453,
        -0.02570771673467133,  0.03713476060144172,   -0.0712075458127371,
        0.08567944789003656,   -0.35351042626184076,  0.15680604965437714,
        -4.514280886258306,    18.41103294873998,     -91.10098260969694,
        122.86073901622036,    4188.889556021369,     -43431.976314088286,
        213939.4226576552,     -610831.4618993952,    1029004.4813998307,
        -950758.4280805739,    372394.4256025409,     -75265.43126316789,
        465364.1840687804,     -1724568.748338329,    2234640.2610367998,
        -3782458.369873854,    10920104.350214915}},
      {"SPI2",
       {0.0014661685098924296, -0.0054003871622916415, 0.010278341102144643,
        -0.016432253354625108, 0.02373230867650821,    -0.04549729684393217,
        0.0547429192595321,    -0.22582439263981982,   0.10019006492133276,
        -2.883580203985684,    11.76045326842061,      -58.20069761009554,
        78.6799490986266,      2673.234632820829,      -27724.882300589234,
        136577.4267928351,     -389958.69931357214,    656927.3533226621,
        -606974.7941839423,    237740.40806354542,     -48049.215020784606,
        297084.9940035301,     -1100949.2513890588,    1426573.0895914857,
        -2414683.4673614274,   6971284.335650493}},
      {"PTE",
       {0.0015258797704752528, -0.0056203899099373875, 0.010697274752741038,
        -0.017102978171956256, 0.024702367735604087,   -0.04736200820477997,
        0.056987568329795645,  -0.2351051104500116,    0.10430029333280418,
        -3.0021594250076515,   12.244043997996764,     -60.59130710975957,
        81.85446149952043,     2783.869910770045,      -28869.8050513242,
        142214.12308054604,    -406048.41210280504,    684028.242906112,
        -632012.6852408283,    247546.68224990237,     -50030.80216143733,
        309336.6851135901,     -1146351.6988797847,    1485403.8847473748,
        -2514262.917802126,    7258773.956651502}}};

  Eigen::Matrix<double, Eigen::Dynamic, Eigen::Dynamic> operator_exponents = {
      0.001, 0.002, 0.004, 0.008, 0.016, 0.032, 0.064, 0.128, 0.256,
      0.512, 1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,
      9.0,   10.0,  20.0,  30.0,  40.0,  50.0,  100.0, 250.0};
  */
  mutable omp_lock_t writelock;
};
} // namespace polyquant
#endif
